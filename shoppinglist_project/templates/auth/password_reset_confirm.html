{% extends "base.html" %}
{% load widget_tweaks %}

{% block content %}
<h2 class="title">新しいパスワードの設定</h2>
<p>新しいパスワードを 2 回入力してください。</p>

<form method="post">
  {% csrf_token %}

  <!-- 1 回目 -->
  <div class="mb-3">
    <label for="id_new_password1" class="form-label">
      パスワード（8文字以上・英数字を含む）
    </label>
    <div class="position-relative">
      {{ form.new_password1|add_class:"form-control pe-5" }}
      <span onclick="togglePw('id_new_password1')" style="position:absolute; right:10px; top:10px; cursor:pointer;">
        <i class="fa-regular fa-eye-slash" id="eye-id_new_password1"></i>
      </span>
    </div>
    {% for error in form.new_password1.errors %}
      <div class="text-danger">{{ error }}</div>
    {% endfor %}
  </div>

  <!-- 2 回目 -->
  <div class="mb-3">
    <label for="id_new_password2" class="form-label">
      パスワード（確認用）
    </label>
    <div class="position-relative">
      {{ form.new_password2|add_class:"form-control pe-5" }}
      <span onclick="togglePw('id_new_password2')" style="position:absolute; right:10px; top:10px; cursor:pointer;">
        <i class="fa-regular fa-eye-slash" id="eye-id_new_password2"></i>
      </span>
    </div>
    {% for error in form.new_password2.errors %}
      <div class="text-danger">{{ error }}</div>
    {% endfor %}
  </div>

  <button type="submit" class="btn btn-primary w-100">変更する</button>
</form>

<script>
function togglePw(id){
  const input = document.getElementById(id);
  const icon  = document.getElementById('eye-'+id);
  if(!input) return;
  if(input.type === 'password'){
      input.type = 'text';
      icon.classList.replace('fa-eye-slash', 'fa-eye');
  }else{
      input.type = 'password';
      icon.classList.replace('fa-eye', 'fa-eye-slash');
  }
}
</script>
{% endblock %}
