{% extends 'base.html' %}
{% block content %}
  <h2>カテゴリをリストに追加</h2>

  <a href="{% url 'app:itemcategory_add' store.store_id %}" 
     class="btn btn-secondary mb-3">
    ＋カテゴリを作成
  </a>

  <form method="post">
    {% csrf_token %}

    <p>追加するカテゴリを選んでください:</p>
    <ul class="list-unstyled">
      {% for category in form.fields.categories.queryset %}
        <li class="mb-2">
          <label class="mb-0">
            <input type="checkbox" name="categories" value="{{ category.id }}">
            {{ category.item_category_name }}
          </label>

          <button type="button"
                  class="btn btn-link text-danger p-0"
                  onclick="if (confirm(`「{{ category.item_category_name }}」を本当に削除しますか？`)) {
                            document.getElementById('delete-cat-{{ category.id }}').submit();
                          }">
              ×
          </button>
          <form id="delete-cat-{{ category.id }}"
                method="POST"
                action="{% url 'app:category_delete' store_id=store.store_id pk=category.id %}"
                style="display: none;">
            {% csrf_token %}
          </form>
        </li>
      {% endfor %}
    </ul>

    <div class="d-flex align-items-center gap-2 mt-3">
      <button type="submit" class="btn btn-primary">リストに追加する</button>
      <a href="{% url 'app:mylist' store_id=view.kwargs.store_id %}" class="link-style cancel-link">キャンセル</a>
    </div>
  </form>
{% endblock %}